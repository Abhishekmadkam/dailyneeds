<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Text & Writing Tools – Pro+</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Professional text analysis and writing tool with advanced features">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e9eef6, #fdfefe);
            min-height: 100vh;
            padding-top: 20px;
            padding-bottom: 40px;
        }
        
        .page-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }
        
        .tool-card {
            background: #fff;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        textarea {
            resize: vertical;
            border-radius: 16px;
            padding: 18px;
            font-size: 15px;
            border: 1px solid #dee2e6;
            width: 100%;
            min-height: 300px;
            font-size: 16px;
        }
        
        textarea:focus {
            outline: none;
            border-color: #4a6bff;
            box-shadow: 0 0 0 3px rgba(74, 107, 255, 0.1);
        }
        
        .stat-box {
            background: #f8f9fd;
            padding: 18px;
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .stat {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 22px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .keyword-box {
            background: #f1f5ff;
            border-radius: 14px;
            padding: 15px;
            max-height: 180px;
            overflow-y: auto;
        }
        
        .keyword {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 8px;
            padding: 5px 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.7);
        }
        
        .keyword:last-child {
            margin-bottom: 0;
        }
        
        .btn {
            border-radius: 14px;
            font-weight: 500;
            transition: all 0.2s;
            padding: 8px 16px;
            border: none;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .output-msg {
            min-height: 24px;
            font-weight: 500;
        }
        
        .ad-space {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            font-size: 14px;
            color: #6c757d;
            margin: 20px 0;
        }
        
        .tool-section {
            border: 1px solid #eaeaea;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            background: #fcfcfc;
        }
        
        .tool-section h5 {
            color: #4a6bff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eaeaea;
        }
        
        .tool-btn {
            margin: 5px;
            font-size: 0.85rem;
        }
        
        /* Dark mode */
        .dark body {
            background: #020617;
            color: #e5e7eb;
        }
        
        .dark .tool-card,
        .dark .header,
        .dark textarea {
            background: #0f172a;
            color: #e5e7eb;
            border-color: #334155;
        }
        
        .dark .stat-box {
            background: #1e293b;
            border: 1px solid #334155;
        }
        
        .dark .keyword-box {
            background: #1e293b;
        }
        
        .dark .keyword {
            background: rgba(30, 41, 59, 0.7);
        }
        
        .dark .stat-value {
            color: #e5e7eb;
        }
        
        .dark .ad-space {
            background: #1e293b;
            border-color: #475569;
            color: #94a3b8;
        }
        
        .dark .tool-section {
            background: #1e293b;
            border-color: #334155;
        }
        
        /* Modal styles */
        .modal-content {
            border-radius: 20px;
            border: none;
        }
        
        .dark .modal-content {
            background: #0f172a;
            color: #e5e7eb;
        }
        
        /* Feature section */
        .feature-section {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid #eaeaea;
        }
        
        .dark .feature-section {
            border-color: #334155;
        }
        
        /* Slider */
        .slider-container {
            margin: 15px 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        /* Progress bar */
        .progress {
            height: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .progress-bar {
            border-radius: 5px;
        }
        
        /* Summary box */
        .summary-box {
            background: #f8f9fd;
            border-radius: 14px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .dark .summary-box {
            background: #1e293b;
        }
        
        /* Font preview */
        .font-preview {
            font-size: 18px;
            padding: 10px;
            border-radius: 10px;
            background: #f8f9fa;
            margin: 10px 0;
        }
        
        .dark .font-preview {
            background: #1e293b;
        }
        
        /* Word cloud container */
        .word-cloud-container {
            height: 200px;
            border-radius: 14px;
            background: #f8f9fd;
            padding: 15px;
            margin: 15px 0;
            overflow: auto;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
        }
        
        .dark .word-cloud-container {
            background: #1e293b;
        }
        
        /* Import/Export buttons */
        .import-export-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        .import-btn, .export-btn {
            flex: 1;
            min-width: 150px;
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        /* Live word count */
        .live-word-count {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
        }
        
        /* Text area wrapper */
        .textarea-wrapper {
            position: relative;
        }
        
        /* Tool categories */
        .tool-category {
            margin-bottom: 30px;
        }
        
        .category-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #4a6bff;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eaeaea;
        }
        
        .dark .category-title {
            color: #60a5fa;
            border-color: #334155;
        }
        
        /* Results area */
        .results-area {
            background: #f8f9fd;
            border-radius: 14px;
            padding: 20px;
            margin-top: 20px;
            min-height: 100px;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-wrap: break-word;
        }
        
        .dark .results-area {
            background: #1e293b;
        }
        
        /* Converter tools */
        .converter-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .converter-col {
            flex: 1;
        }
        
        @media (max-width: 768px) {
            .converter-row {
                flex-direction: column;
            }
        }
        
        /* Code formatting */
        .code-area {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
        }
        
        .dark .code-area {
            background: #1e293b;
        }
        
        /* Tab navigation */
        .nav-tabs {
            border-bottom: 2px solid #eaeaea;
        }
        
        .dark .nav-tabs {
            border-bottom-color: #334155;
        }
        
        .nav-tabs .nav-link {
            border: none;
            color: #6c757d;
            font-weight: 500;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
        }
        
        .nav-tabs .nav-link.active {
            color: #4a6bff;
            background-color: rgba(74, 107, 255, 0.1);
            border-bottom: 2px solid #4a6bff;
        }
        
        .dark .nav-tabs .nav-link.active {
            color: #60a5fa;
            background-color: rgba(96, 165, 250, 0.1);
            border-bottom-color: #60a5fa;
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <!-- HEADER -->
        <div class="header d-flex justify-content-between align-items-center flex-wrap gap-3">
            <div>
                <h1 class="fw-bold mb-1"><i class="bi bi-pencil-square"></i> Text & Writing Tools Pro+</h1>
                <p class="text-muted mb-0">Professional text analysis and writing workspace with 50+ tools</p>
            </div>
            <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-outline-dark btn-sm" onclick="toggleDark()"><i class="bi bi-moon"></i> Dark</button>
                <button class="btn btn-outline-primary btn-sm" onclick="openImportModal()"><i class="bi bi-upload"></i> Import</button>
                <button class="btn btn-outline-primary btn-sm" onclick="downloadTXT()"><i class="bi bi-filetype-txt"></i> TXT</button>
                <button class="btn btn-outline-primary btn-sm" onclick="downloadHTML()"><i class="bi bi-filetype-html"></i> HTML</button>
                <button class="btn btn-outline-secondary btn-sm" onclick="undo()"><i class="bi bi-arrow-counterclockwise"></i> Undo</button>
                <button class="btn btn-outline-secondary btn-sm" onclick="redo()"><i class="bi bi-arrow-clockwise"></i> Redo</button>
                <button class="btn btn-outline-info btn-sm" onclick="toggleAdvanced()"><i class="bi bi-gear"></i> Advanced</button>
            </div>
        </div>
        
        <!-- TOP AD -->
        <div class="ad-space">Advertisement Space (Top Banner – AdSense Ready)</div>
        
        <!-- MAIN TOOL CARD -->
        <div class="tool-card">
            <!-- TEXT AREA -->
            <div class="textarea-wrapper mb-4">
                <textarea id="text" class="form-control" placeholder="Start typing or paste text here...">This is a sample text to demonstrate the features of Text & Writing Tools Pro+. You can analyze this text, transform it, or replace it with your own content. Try the various features like word counting, keyword analysis, and text transformations.

Text analysis tools help writers improve their content. They provide insights into readability, keyword usage, and overall text quality. This comprehensive toolkit includes everything you need for professional writing and content creation.

Key features include:
- Word and character counting
- Sentence and paragraph analysis
- Reading time calculation
- Text formatting and case conversion
- Grammar and spell checking
- SEO content analysis
- Text cleaning and processing
- Developer tools for code formatting
- File conversion utilities</textarea>
                <div class="live-word-count" id="liveWordCount">91 words</div>
            </div>
            
            <!-- TAB NAVIGATION -->
            <ul class="nav nav-tabs" id="toolTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="basic-tab" data-bs-toggle="tab" data-bs-target="#basic" type="button" role="tab">Basic Tools</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="formatting-tab" data-bs-toggle="tab" data-bs-target="#formatting" type="button" role="tab">Formatting</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="writing-tab" data-bs-toggle="tab" data-bs-target="#writing" type="button" role="tab">Writing & Editing</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="seo-tab" data-bs-toggle="tab" data-bs-target="#seo" type="button" role="tab">SEO & Content</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="cleaning-tab" data-bs-toggle="tab" data-bs-target="#cleaning" type="button" role="tab">Cleaning</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="dev-tab" data-bs-toggle="tab" data-bs-target="#dev" type="button" role="tab">Developer</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="converter-tab" data-bs-toggle="tab" data-bs-target="#converter" type="button" role="tab">Converters</button>
                </li>
            </ul>
            
            <!-- TAB CONTENT -->
            <div class="tab-content pt-4" id="toolTabsContent">
                <!-- BASIC TOOLS TAB -->
                <div class="tab-pane fade show active" id="basic" role="tabpanel">
                    <div class="row g-3 mb-4">
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Word Counter')">
                                <div class="stat">Words</div>
                                <div class="stat-value" id="words">91</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Character Counter')">
                                <div class="stat">Characters</div>
                                <div class="stat-value" id="chars">601</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Sentence Counter')">
                                <div class="stat">Sentences</div>
                                <div class="stat-value" id="sentences">6</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Paragraph Counter')">
                                <div class="stat">Paragraphs</div>
                                <div class="stat-value" id="paras">3</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row g-3 mb-4">
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Reading Time Calculator')">
                                <div class="stat">Reading Time</div>
                                <div class="stat-value" id="readTime">1 min</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Speaking Time Calculator')">
                                <div class="stat">Speaking Time</div>
                                <div class="stat-value" id="speakTime">1 min</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Text Length Checker')">
                                <div class="stat">Text Length</div>
                                <div class="stat-value" id="textLength">Medium</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-box" onclick="showToolInfo('Unique Words')">
                                <div class="stat">Unique Words</div>
                                <div class="stat-value" id="unique">62</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- INLINE AD -->
                    <div class="ad-space">Advertisement Space (Inline / Responsive)</div>
                    
                    <!-- KEYWORDS & FIND -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <h6 class="fw-semibold"><i class="bi bi-key"></i> Keyword Density</h6>
                            <div class="keyword-box" id="keywords">
                                <!-- Keywords will be populated here -->
                            </div>
                            <div class="slider-container">
                                <div class="slider-label">
                                    <span>Keyword Count:</span>
                                    <span id="keywordCountValue">10</span>
                                </div>
                                <input type="range" class="form-range" id="keywordCount" min="5" max="30" value="10" oninput="updateKeywordCount()">
                            </div>
                            <button class="btn btn-sm btn-outline-info mt-2" onclick="generateWordCloud()"><i class="bi bi-cloud"></i> Generate Word Cloud</button>
                        </div>
                        <div class="col-md-6">
                            <h6 class="fw-semibold"><i class="bi bi-search"></i> Find & Replace</h6>
                            <input class="form-control mb-2" id="findText" placeholder="Find">
                            <input class="form-control mb-2" id="replaceText" placeholder="Replace">
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-primary" onclick="findReplace()">Replace All</button>
                                <button class="btn btn-sm btn-outline-primary" onclick="findNext()">Find Next</button>
                                <div class="d-flex align-items-center gap-2">
                                    <input type="checkbox" class="form-check-input" id="caseSensitive">
                                    <label class="form-check-label small" for="caseSensitive">Case-sensitive</label>
                                </div>
                            </div>
                            <div class="mt-2">
                                <button class="btn btn-sm btn-info" onclick="replaceSelected()">Replace Selected</button>
                                <button class="btn btn-sm btn-outline-secondary" onclick="highlightAll()">Highlight All</button>
                            </div>
                            <div class="mt-2 small text-muted" id="findResults"></div>
                        </div>
                    </div>
                    
                    <!-- TEXT PROGRESS -->
                    <div class="mb-4" id="textProgressContainer">
                        <div class="slider-label">
                            <span>Text Length Progress</span>
                            <span id="progressPercent">9%</span>
                        </div>
                        <div class="progress">
                            <div id="textProgress" class="progress-bar bg-success" role="progressbar" style="width: 9%"></div>
                        </div>
                        <div class="text-center small text-muted mt-1" id="progressText">91 of 1000 words</div>
                    </div>
                </div>
                
                <!-- FORMATTING TAB -->
                <div class="tab-pane fade" id="formatting" role="tabpanel">
                    <h5 class="category-title"><i class="bi bi-type"></i> Formatting & Case Tools</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6>Case Conversion</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-primary tool-btn" onclick="toUpper()"><i class="bi bi-type-bold"></i> UPPERCASE</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="toLower()"><i class="bi bi-type"></i> lowercase</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="toSentenceCase()"><i class="bi bi-text-paragraph"></i> Sentence Case</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="toTitleCase()"><i class="bi bi-type-h2"></i> Title Case</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="toToggleCase()"><i class="bi bi-arrow-left-right"></i> Toggle Case</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="capitalizeFirstLetter()"><i class="bi bi-type-h1"></i> Capitalize First</button>
                            </div>
                            
                            <h6 class="mt-4">Text Alignment</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-secondary tool-btn" onclick="alignText('left')"><i class="bi bi-text-left"></i> Align Left</button>
                                <button class="btn btn-outline-secondary tool-btn" onclick="alignText('center')"><i class="bi bi-text-center"></i> Align Center</button>
                                <button class="btn btn-outline-secondary tool-btn" onclick="alignText('right')"><i class="bi bi-text-right"></i> Align Right</button>
                                <button class="btn btn-outline-secondary tool-btn" onclick="alignText('justify')"><i class="bi bi-justify"></i> Justify</button>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6>Space & Line Formatting</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-warning tool-btn" onclick="removeExtraSpaces()"><i class="bi bi-text-indent-left"></i> Remove Extra Spaces</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="removeLineBreaks()"><i class="bi bi-textarea-t"></i> Remove Line Breaks</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="trimLines()"><i class="bi bi-scissors"></i> Trim Lines</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="normalizeSpaces()"><i class="bi bi-text-indent-right"></i> Normalize Spaces</button>
                            </div>
                            
                            <h6 class="mt-4">Text Structure</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-info tool-btn" onclick="addLineNumbers()"><i class="bi bi-list-ol"></i> Add Line Numbers</button>
                                <button class="btn btn-outline-info tool-btn" onclick="addBullets()"><i class="bi bi-list-ul"></i> Add Bullets</button>
                                <button class="btn btn-outline-info tool-btn" onclick="indentText()"><i class="bi bi-indent"></i> Indent Text</button>
                                <button class="btn btn-outline-info tool-btn" onclick="outdentText()"><i class="bi bi-outdent"></i> Outdent Text</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-area" id="formattingResults">
                        <!-- Results will appear here -->
                    </div>
                </div>
                
                <!-- WRITING & EDITING TAB -->
                <div class="tab-pane fade" id="writing" role="tabpanel">
                    <h5 class="category-title"><i class="bi bi-pencil"></i> Writing & Editing Tools</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6>Grammar & Spelling</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-primary tool-btn" onclick="checkGrammar()"><i class="bi bi-check-circle"></i> Grammar Check</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="checkSpelling()"><i class="bi bi-spellcheck"></i> Spell Check</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="autoCorrect()"><i class="bi bi-magic"></i> Auto Correct</button>
                            </div>
                            
                            <h6 class="mt-4">Text Rewriting</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-success tool-btn" onclick="rewriteText()"><i class="bi bi-arrow-repeat"></i> Rewrite Text</button>
                                <button class="btn btn-outline-success tool-btn" onclick="paraphraseText()"><i class="bi bi-chat-left-text"></i> Paraphrase</button>
                                <button class="btn btn-outline-success tool-btn" onclick="improveContent()"><i class="bi bi-lightning"></i> Improve Content</button>
                                <button class="btn btn-outline-success tool-btn" onclick="simplifyText()"><i class="bi bi-file-text"></i> Simplify Text</button>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6>Voice Conversion</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-info tool-btn" onclick="passiveToActive()"><i class="bi bi-arrow-right-circle"></i> Passive to Active</button>
                                <button class="btn btn-outline-info tool-btn" onclick="activeToPassive()"><i class="bi bi-arrow-left-circle"></i> Active to Passive</button>
                            </div>
                            
                            <h6 class="mt-4">Text Analysis</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-warning tool-btn" onclick="analyzeReadability()"><i class="bi bi-graph-up"></i> Readability Score</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="analyzeTone()"><i class="bi bi-emoji-smile"></i> Tone Analysis</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="checkPlagiarism()"><i class="bi bi-shield-check"></i> Plagiarism Check</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-area" id="writingResults">
                        <!-- Results will appear here -->
                    </div>
                </div>
                
                <!-- SEO & CONTENT TAB -->
                <div class="tab-pane fade" id="seo" role="tabpanel">
                    <h5 class="category-title"><i class="bi bi-search"></i> SEO & Content Tools</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6>SEO Analysis</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-primary tool-btn" onclick="checkKeywordDensity()"><i class="bi bi-bar-chart"></i> Keyword Density</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="analyzeSEO()"><i class="bi bi-search-heart"></i> SEO Content Analyzer</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="findFocusKeyword()"><i class="bi bi-bullseye"></i> Focus Keyword Finder</button>
                            </div>
                            
                            <h6 class="mt-4">Content Generation</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-success tool-btn" onclick="generateMetaDescription()"><i class="bi bi-card-text"></i> Meta Description</button>
                                <button class="btn btn-outline-success tool-btn" onclick="generateTitle()"><i class="bi bi-type-h1"></i> Title Generator</button>
                                <button class="btn btn-outline-success tool-btn" onclick="generateSlug()"><i class="bi bi-link-45deg"></i> Slug Generator</button>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6>Content Optimization</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-info tool-btn" onclick="optimizeHeadings()"><i class="bi bi-type-h1"></i> Optimize Headings</button>
                                <button class="btn btn-outline-info tool-btn" onclick="addInternalLinks()"><i class="bi bi-link"></i> Add Internal Links</button>
                                <button class="btn btn-outline-info tool-btn" onclick="generateFAQ()"><i class="bi bi-question-circle"></i> Generate FAQ</button>
                            </div>
                            
                            <h6 class="mt-4">Content Scoring</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-warning tool-btn" onclick="calculateContentScore()"><i class="bi bi-star"></i> Content Score</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="checkReadabilityScore()"><i class="bi bi-book"></i> Readability</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="analyzeEngagement()"><i class="bi bi-people"></i> Engagement Score</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-area" id="seoResults">
                        <!-- Results will appear here -->
                    </div>
                </div>
                
                <!-- CLEANING TAB -->
                <div class="tab-pane fade" id="cleaning" role="tabpanel">
                    <h5 class="category-title"><i class="bi bi-broom"></i> Cleaning & Utility Tools</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6>Text Cleaning</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-primary tool-btn" onclick="removeDuplicateLines()"><i class="bi bi-x-circle"></i> Remove Duplicate Lines</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="sortLinesAsc()"><i class="bi bi-sort-alpha-down"></i> Sort A–Z</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="sortLinesDesc()"><i class="bi bi-sort-alpha-down-alt"></i> Sort Z–A</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="reverseLines()"><i class="bi bi-arrow-down-up"></i> Reverse Lines</button>
                            </div>
                            
                            <h6 class="mt-4">Character Cleaning</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-warning tool-btn" onclick="removeSpecialChars()"><i class="bi bi-slash-circle"></i> Remove Special Characters</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="removeNumbers()"><i class="bi bi-123"></i> Remove Numbers</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="removePunctuation()"><i class="bi bi-punctuation"></i> Remove Punctuation</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="removeEmojis()"><i class="bi bi-emoji-smile"></i> Remove Emojis</button>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6>Data Extraction</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-success tool-btn" onclick="extractNumbers()"><i class="bi bi-123"></i> Extract Numbers</button>
                                <button class="btn btn-outline-success tool-btn" onclick="extractEmails()"><i class="bi bi-envelope"></i> Extract Emails</button>
                                <button class="btn btn-outline-success tool-btn" onclick="extractURLs()"><i class="bi bi-link-45deg"></i> Extract URLs</button>
                                <button class="btn btn-outline-success tool-btn" onclick="extractHashtags()"><i class="bi bi-hash"></i> Extract Hashtags</button>
                            </div>
                            
                            <h6 class="mt-4">Text Manipulation</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-info tool-btn" onclick="reverseText()"><i class="bi bi-arrow-left-right"></i> Reverse Text</button>
                                <button class="btn btn-outline-info tool-btn" onclick="shuffleLines()"><i class="bi bi-shuffle"></i> Shuffle Lines</button>
                                <button class="btn btn-outline-info tool-btn" onclick="mergeLines()"><i class="bi bi-arrow-bar-right"></i> Merge Lines</button>
                                <button class="btn btn-outline-info tool-btn" onclick="splitIntoSentences()"><i class="bi bi-text-split"></i> Split Sentences</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-area" id="cleaningResults">
                        <!-- Results will appear here -->
                    </div>
                </div>
                
                <!-- DEVELOPER TAB -->
                <div class="tab-pane fade" id="dev" role="tabpanel">
                    <h5 class="category-title"><i class="bi bi-code-slash"></i> Developer / Technical Tools</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6>Code Formatting</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-primary tool-btn" onclick="formatJSON()"><i class="bi bi-braces"></i> Format JSON</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="formatXML()"><i class="bi bi-code-square"></i> Format XML</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="minifyHTML()"><i class="bi bi-filetype-html"></i> Minify HTML</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="beautifyHTML()"><i class="bi bi-filetype-html"></i> Beautify HTML</button>
                            </div>
                            
                            <h6 class="mt-4">Code Optimization</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-warning tool-btn" onclick="minifyCSS()"><i class="bi bi-filetype-css"></i> Minify CSS</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="minifyJS()"><i class="bi bi-filetype-js"></i> Minify JavaScript</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="validateJSON()"><i class="bi bi-check-square"></i> Validate JSON</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="validateXML()"><i class="bi bi-check-square"></i> Validate XML</button>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6>Code Conversion</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-success tool-btn" onclick="codeToText()"><i class="bi bi-file-earmark-text"></i> Code to Text</button>
                                <button class="btn btn-outline-success tool-btn" onclick="textToCode()"><i class="bi bi-file-earmark-code"></i> Text to Code</button>
                                <button class="btn btn-outline-success tool-btn" onclick="htmlToMarkdown()"><i class="bi bi-markdown"></i> HTML to Markdown</button>
                                <button class="btn btn-outline-success tool-btn" onclick="markdownToHTML()"><i class="bi bi-filetype-html"></i> Markdown to HTML</button>
                            </div>
                            
                            <h6 class="mt-4">Encoding/Decoding</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-info tool-btn" onclick="encodeBase64()"><i class="bi bi-lock"></i> Encode Base64</button>
                                <button class="btn btn-outline-info tool-btn" onclick="decodeBase64()"><i class="bi bi-unlock"></i> Decode Base64</button>
                                <button class="btn btn-outline-info tool-btn" onclick="encodeURL()"><i class="bi bi-link-45deg"></i> Encode URL</button>
                                <button class="btn btn-outline-info tool-btn" onclick="decodeURL()"><i class="bi bi-link-45deg"></i> Decode URL</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-area" id="devResults">
                        <!-- Results will appear here -->
                    </div>
                </div>
                
                <!-- CONVERTER TAB -->
                <div class="tab-pane fade" id="converter" role="tabpanel">
                    <h5 class="category-title"><i class="bi bi-arrow-left-right"></i> Converter Tools</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6>File Conversion</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-primary tool-btn" onclick="textToPDF()"><i class="bi bi-filetype-pdf"></i> Text to PDF</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="pdfToText()"><i class="bi bi-file-earmark-text"></i> PDF to Text</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="textToImage()"><i class="bi bi-filetype-png"></i> Text to Image</button>
                                <button class="btn btn-outline-primary tool-btn" onclick="imageToText()"><i class="bi bi-image-text"></i> Image to Text (OCR)</button>
                            </div>
                            
                            <h6 class="mt-4">Speech Conversion</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-success tool-btn" onclick="textToSpeech()"><i class="bi bi-volume-up"></i> Text to Speech</button>
                                <button class="btn btn-outline-success tool-btn" onclick="speechToText()"><i class="bi bi-mic"></i> Speech to Text</button>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6>Markdown Conversion</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-info tool-btn" onclick="markdownToHTMLConv()"><i class="bi bi-filetype-html"></i> Markdown to HTML</button>
                                <button class="btn btn-outline-info tool-btn" onclick="htmlToMarkdownConv()"><i class="bi bi-markdown"></i> HTML to Markdown</button>
                                <button class="btn btn-outline-info tool-btn" onclick="textToCSV()"><i class="bi bi-filetype-csv"></i> Text to CSV</button>
                                <button class="btn btn-outline-info tool-btn" onclick="csvToText()"><i class="bi bi-file-earmark-text"></i> CSV to Text</button>
                            </div>
                            
                            <h6 class="mt-4">Encoding Conversion</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <button class="btn btn-outline-warning tool-btn" onclick="textToBinary()"><i class="bi bi-0-circle"></i> Text to Binary</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="binaryToText()"><i class="bi bi-type"></i> Binary to Text</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="textToHex()"><i class="bi bi-hexagon"></i> Text to Hex</button>
                                <button class="btn btn-outline-warning tool-btn" onclick="hexToText()"><i class="bi bi-type"></i> Hex to Text</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="converter-row">
                        <div class="converter-col">
                            <h6>Input</h6>
                            <textarea class="form-control" id="converterInput" rows="6" placeholder="Enter text to convert..."></textarea>
                        </div>
                        <div class="converter-col">
                            <h6>Output</h6>
                            <div class="results-area" id="converterOutput" style="min-height: 150px;">
                                Converted output will appear here
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ACTIONS -->
            <h6 class="fw-semibold mt-4"><i class="bi bi-lightning"></i> Actions</h6>
            <div class="d-flex flex-wrap gap-2 mb-3">
                <button class="btn btn-success" onclick="copyText()"><i class="bi bi-clipboard"></i> Copy</button>
                <button class="btn btn-outline-primary" onclick="downloadMD()"><i class="bi bi-markdown"></i> Markdown</button>
                <button class="btn btn-outline-primary" onclick="downloadJSON()"><i class="bi bi-filetype-json"></i> JSON</button>
                <button class="btn btn-outline-primary" onclick="downloadPDF()"><i class="bi bi-filetype-pdf"></i> PDF</button>
                <button class="btn btn-danger" onclick="clearText()"><i class="bi bi-trash"></i> Clear</button>
            </div>
            
            <!-- IMPORT/EXPORT -->
            <div class="import-export-container">
                <button class="btn btn-outline-primary import-btn" onclick="importFromFile()"><i class="bi bi-file-earmark-arrow-up"></i> Import from File</button>
                <button class="btn btn-outline-primary import-btn" onclick="importFromURL()"><i class="bi bi-link"></i> Import from URL</button>
                <button class="btn btn-outline-primary import-btn" onclick="importFromClipboard()"><i class="bi bi-clipboard-data"></i> Import from Clipboard</button>
                <button class="btn btn-outline-success export-btn" onclick="exportAllData()"><i class="bi bi-box-arrow-down"></i> Export All Data</button>
            </div>
            
            <!-- OUTPUT MESSAGE -->
            <p class="mt-3 fw-semibold text-success output-msg" id="output"></p>
        </div>
        
        <!-- BOTTOM AD -->
        <div class="ad-space">Advertisement Space (Bottom Banner – AdSense Ready)</div>
        
        <!-- FOOTER -->
        <hr class="my-5">
        <p class="text-center text-muted small">© 2025 FreeTools by teamorbits – Pro+ | v2.1</p>
    </div>
    
    <!-- IMPORT MODAL -->
    <div class="modal fade" id="importModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-upload"></i> Import Text</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Import from File</label>
                        <input type="file" id="fileInput" class="form-control" accept=".txt,.html,.md,.json,.xml,.csv">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Import from URL</label>
                        <input type="url" id="urlInput" class="form-control" placeholder="https://example.com/text.txt">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Direct Text Input</label>
                        <textarea id="directInput" class="form-control" rows="4" placeholder="Paste text directly here..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="processImport()">Import Text</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- WORD CLOUD MODAL -->
    <div class="modal fade" id="wordCloudModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-cloud"></i> Word Cloud</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="word-cloud-container" id="wordCloud"></div>
                    <div class="mt-3">
                        <button class="btn btn-primary" onclick="regenerateWordCloud()"><i class="bi bi-arrow-clockwise"></i> Regenerate</button>
                        <button class="btn btn-success" onclick="saveWordCloud()"><i class="bi bi-download"></i> Save as Image</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Core variables
        const textArea = document.getElementById('text');
        let history = [];
        let historyIndex = -1;
        let wordCloudData = [];
        let fontSize = 16;
        
        // Initialize Bootstrap modals
        const importModal = new bootstrap.Modal(document.getElementById('importModal'));
        const wordCloudModalInstance = new bootstrap.Modal(document.getElementById('wordCloudModal'));
        
        // Initialize the application
        function init() {
            // Load saved text from localStorage
            const savedText = localStorage.getItem('textToolsText');
            if (savedText) {
                textArea.value = savedText;
            }
            
            // Save initial state to history
            saveHistory();
            
            // Analyze the initial text
            analyze();
            
            // Set up event listeners
            setupEventListeners();
            
            // Load settings
            loadSettings();
            
            // Show welcome message
            setTimeout(() => {
                if (!localStorage.getItem('welcomeShown')) {
                    showMessage('Welcome to Text & Writing Tools Pro+! Start typing or paste text to analyze.');
                    localStorage.setItem('welcomeShown', 'true');
                }
            }, 1000);
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Text area input
            textArea.addEventListener('input', function() {
                saveHistory();
                localStorage.setItem('textToolsText', textArea.value);
                analyze();
                updateLiveWordCount();
            });
            
            // Keyboard shortcuts
            textArea.addEventListener('keydown', function(e) {
                // Ctrl+Z for undo
                if (e.ctrlKey && e.key === 'z') {
                    e.preventDefault();
                    undo();
                }
                // Ctrl+Y for redo
                if (e.ctrlKey && e.key === 'y') {
                    e.preventDefault();
                    redo();
                }
                // Ctrl+F for find
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    document.getElementById('findText').focus();
                }
            });
            
            // File input
            document.getElementById('fileInput').addEventListener('change', function() {
                if (this.files.length > 0) {
                    readFile(this.files[0]);
                }
            });
        }
        
        // History management
        function saveHistory() {
            // Remove future history if we're not at the end
            if (historyIndex < history.length - 1) {
                history = history.slice(0, historyIndex + 1);
            }
            
            // Add current state to history
            history.push(textArea.value);
            historyIndex = history.length - 1;
            
            // Limit history size
            if (history.length > 50) {
                history.shift();
                historyIndex--;
            }
        }
        
        function undo() {
            if (historyIndex > 0) {
                historyIndex--;
                textArea.value = history[historyIndex];
                analyze();
                showMessage('Undo performed');
            }
        }
        
        function redo() {
            if (historyIndex < history.length - 1) {
                historyIndex++;
                textArea.value = history[historyIndex];
                analyze();
                showMessage('Redo performed');
            }
        }
        
        // Core analysis function
        function analyze() {
            const text = textArea.value;
            const words = text.trim() ? text.trim().split(/\s+/) : [];
            const lines = text ? text.split('\n') : [];
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            const paragraphs = text ? text.split(/\n\s*\n/).filter(p => p.trim()) : [];
            
            // Update basic stats
            document.getElementById('words').textContent = words.length;
            document.getElementById('chars').textContent = text.length;
            document.getElementById('sentences').textContent = sentences.length;
            document.getElementById('paras').textContent = paragraphs.length;
            document.getElementById('unique').textContent = [...new Set(words.map(w => w.toLowerCase()))].length;
            
            // Calculate reading and speaking time
            const readTime = Math.ceil(words.length / 200);
            const speakTime = Math.ceil(words.length / 130);
            document.getElementById('readTime').textContent = readTime + ' min';
            document.getElementById('speakTime').textContent = speakTime + ' min';
            
            // Determine text length category
            let textLength = 'Short';
            if (words.length > 500) textLength = 'Long';
            else if (words.length > 200) textLength = 'Medium';
            document.getElementById('textLength').textContent = textLength;
            
            // Update keyword density
            updateKeywordDensity(text);
            
            // Update progress
            updateTextProgress(words.length);
            
            // Update live word count
            updateLiveWordCount();
        }
        
        function updateKeywordDensity(text) {
            if (!text.trim()) {
                document.getElementById('keywords').innerHTML = '<div class="text-muted">No data</div>';
                return;
            }
            
            const words = text.toLowerCase().match(/\b[a-z]{3,}\b/g) || [];
            const wordCount = words.length;
            
            if (wordCount === 0) {
                document.getElementById('keywords').innerHTML = '<div class="text-muted">No keywords found</div>';
                return;
            }
            
            // Count word frequencies
            const frequencies = {};
            words.forEach(word => {
                frequencies[word] = (frequencies[word] || 0) + 1;
            });
            
            // Sort by frequency
            const sorted = Object.entries(frequencies).sort((a, b) => b[1] - a[1]);
            
            // Get the number of keywords to show
            const keywordCount = parseInt(document.getElementById('keywordCount').value) || 10;
            const topKeywords = sorted.slice(0, keywordCount);
            
            // Display keywords
            let html = '';
            topKeywords.forEach(([word, count]) => {
                const percentage = ((count / wordCount) * 100).toFixed(1);
                html += `<div class="keyword"><span>${word}</span><span>${count} (${percentage}%)</span></div>`;
            });
            
            document.getElementById('keywords').innerHTML = html;
        }
        
        function updateKeywordCount() {
            const value = document.getElementById('keywordCount').value;
            document.getElementById('keywordCountValue').textContent = value;
            updateKeywordDensity(textArea.value);
        }
        
        function updateTextProgress(wordCount) {
            const goal = 1000;
            const percent = Math.min(100, Math.round((wordCount / goal) * 100));
            
            document.getElementById('textProgress').style.width = percent + '%';
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('progressText').textContent = `${wordCount} of ${goal} words`;
        }
        
        function updateLiveWordCount() {
            const wordCount = textArea.value.trim() ? textArea.value.trim().split(/\s+/).length : 0;
            document.getElementById('liveWordCount').textContent = `${wordCount} words`;
        }
        
        // Find and replace functions
        function findReplace() {
            const findText = document.getElementById('findText').value;
            const replaceText = document.getElementById('replaceText').value;
            const caseSensitive = document.getElementById('caseSensitive').checked;
            
            if (!findText) {
                showMessage('Please enter text to find');
                return;
            }
            
            saveHistory();
            
            if (caseSensitive) {
                textArea.value = textArea.value.split(findText).join(replaceText);
            } else {
                const regex = new RegExp(findText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                textArea.value = textArea.value.replace(regex, replaceText);
            }
            
            analyze();
            showMessage(`Replaced all occurrences of "${findText}"`);
        }
        
        function findNext() {
            const findText = document.getElementById('findText').value;
            const caseSensitive = document.getElementById('caseSensitive').checked;
            
            if (!findText) {
                showMessage('Please enter text to find');
                return;
            }
            
            const text = textArea.value;
            const searchText = caseSensitive ? findText : findText.toLowerCase();
            const content = caseSensitive ? text : text.toLowerCase();
            
            // Start searching from current cursor position
            const startPos = textArea.selectionStart;
            const pos = content.indexOf(searchText, startPos);
            
            if (pos >= 0) {
                textArea.focus();
                textArea.setSelectionRange(pos, pos + findText.length);
                showMessage(`Found at position ${pos}`);
            } else {
                // Search from beginning if not found
                const posFromStart = content.indexOf(searchText);
                if (posFromStart >= 0) {
                    textArea.focus();
                    textArea.setSelectionRange(posFromStart, posFromStart + findText.length);
                    showMessage(`Found at position ${posFromStart}`);
                } else {
                    showMessage('Text not found');
                }
            }
        }
        
        function replaceSelected() {
            const selection = textArea.value.substring(textArea.selectionStart, textArea.selectionEnd);
            const replaceText = document.getElementById('replaceText').value;
            
            if (!selection) {
                showMessage('Please select text first');
                return;
            }
            
            saveHistory();
            const before = textArea.value.substring(0, textArea.selectionStart);
            const after = textArea.value.substring(textArea.selectionEnd);
            textArea.value = before + replaceText + after;
            
            analyze();
            showMessage('Replaced selected text');
        }
        
        function highlightAll() {
            const findText = document.getElementById('findText').value;
            
            if (!findText) {
                showMessage('Please enter text to find');
                return;
            }
            
            const text = textArea.value;
            const regex = new RegExp(findText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
            const matches = [...text.matchAll(regex)];
            
            if (matches.length === 0) {
                document.getElementById('findResults').innerHTML = '<div class="text-warning">No matches found</div>';
            } else {
                document.getElementById('findResults').innerHTML = `<div class="text-success">Found ${matches.length} matches</div>`;
                showMessage(`Found ${matches.length} matches`);
            }
        }
        
        // FORMATTING TOOLS
        function toUpper() {
            saveHistory();
            textArea.value = textArea.value.toUpperCase();
            analyze();
            showMessage('Converted to uppercase');
        }
        
        function toLower() {
            saveHistory();
            textArea.value = textArea.value.toLowerCase();
            analyze();
            showMessage('Converted to lowercase');
        }
        
        function toSentenceCase() {
            saveHistory();
            textArea.value = textArea.value.toLowerCase().replace(/(^\s*\w|[.!?]\s+\w)/g, function(c) {
                return c.toUpperCase();
            });
            analyze();
            showMessage('Converted to sentence case');
        }
        
        function toTitleCase() {
            saveHistory();
            textArea.value = textArea.value.toLowerCase().replace(/\b\w+/g, function(word) {
                const smallWords = ['a', 'an', 'and', 'as', 'at', 'but', 'by', 'for', 'in', 'of', 'on', 'or', 'the', 'to', 'with'];
                if (smallWords.includes(word)) return word;
                return word.charAt(0).toUpperCase() + word.slice(1);
            });
            // Capitalize first word
            textArea.value = textArea.value.charAt(0).toUpperCase() + textArea.value.slice(1);
            analyze();
            showMessage('Converted to title case');
        }
        
        function toToggleCase() {
            saveHistory();
            let result = '';
            for (let i = 0; i < textArea.value.length; i++) {
                const char = textArea.value[i];
                result += i % 2 === 0 ? char.toUpperCase() : char.toLowerCase();
            }
            textArea.value = result;
            analyze();
            showMessage('Converted to toggle case');
        }
        
        function capitalizeFirstLetter() {
            saveHistory();
            textArea.value = textArea.value.toLowerCase().replace(/\b\w/g, char => char.toUpperCase());
            analyze();
            showMessage('Text capitalized');
        }
        
        function removeExtraSpaces() {
            saveHistory();
            textArea.value = textArea.value.replace(/\s+/g, ' ').trim();
            analyze();
            showMessage('Extra spaces removed');
        }
        
        function removeLineBreaks() {
            saveHistory();
            textArea.value = textArea.value.replace(/\n/g, ' ').replace(/\s+/g, ' ').trim();
            analyze();
            showMessage('Line breaks removed');
        }
        
        function trimLines() {
            saveHistory();
            textArea.value = textArea.value.split('\n').map(line => line.trim()).join('\n');
            analyze();
            showMessage('Lines trimmed');
        }
        
        function normalizeSpaces() {
            saveHistory();
            textArea.value = textArea.value.replace(/\t/g, '    ').replace(/[ \t]+/g, ' ').trim();
            analyze();
            showMessage('Spaces normalized');
        }
        
        function alignText(alignment) {
            saveHistory();
            const lines = textArea.value.split('\n');
            const maxLength = Math.max(...lines.map(line => line.length));
            
            const alignedLines = lines.map(line => {
                switch(alignment) {
                    case 'center':
                        const padding = Math.floor((maxLength - line.length) / 2);
                        return ' '.repeat(Math.max(0, padding)) + line;
                    case 'right':
                        return ' '.repeat(Math.max(0, maxLength - line.length)) + line;
                    case 'justify':
                        // Simple justification
                        const words = line.split(' ');
                        if (words.length <= 1) return line;
                        const spacesToAdd = maxLength - line.length;
                        const spacesPerGap = Math.floor(spacesToAdd / (words.length - 1));
                        const extraSpaces = spacesToAdd % (words.length - 1);
                        
                        let justified = words[0];
                        for (let i = 1; i < words.length; i++) {
                            const spaces = ' '.repeat(1 + spacesPerGap + (i <= extraSpaces ? 1 : 0));
                            justified += spaces + words[i];
                        }
                        return justified;
                    default:
                        return line;
                }
            });
            
            textArea.value = alignedLines.join('\n');
            analyze();
            showMessage(`Text aligned ${alignment}`);
        }
        
        function addLineNumbers() {
            saveHistory();
            textArea.value = textArea.value.split('\n').map((line, index) => `${index + 1}. ${line}`).join('\n');
            analyze();
            showMessage('Line numbers added');
        }
        
        function addBullets() {
            saveHistory();
            textArea.value = textArea.value.split('\n').map(line => line.trim() ? '• ' + line : '').join('\n');
            analyze();
            showMessage('Bullets added');
        }
        
        function indentText() {
            saveHistory();
            textArea.value = textArea.value.split('\n').map(line => '    ' + line).join('\n');
            analyze();
            showMessage('Text indented');
        }
        
        function outdentText() {
            saveHistory();
            textArea.value = textArea.value.split('\n').map(line => line.replace(/^\s{1,4}/, '')).join('\n');
            analyze();
            showMessage('Text outdented');
        }
        
        // WRITING & EDITING TOOLS
        function checkGrammar() {
            const text = textArea.value;
            // Simple grammar check simulation
            const issues = [];
            
            // Check for repeated words
            const words = text.split(/\s+/);
            for (let i = 1; i < words.length; i++) {
                if (words[i].toLowerCase() === words[i-1].toLowerCase()) {
                    issues.push(`Repeated word: "${words[i]}"`);
                }
            }
            
            // Check for common errors
            const commonErrors = [
                { pattern: /\byour\b.*\byou're\b/gi, message: "Possible confusion between 'your' and 'you're'" },
                { pattern: /\btheir\b.*\bthey're\b.*\bthere\b/gi, message: "Possible confusion between 'their', 'they're', and 'there'" },
                { pattern: /\bit's\b.*\bits\b/gi, message: "Possible confusion between 'it's' and 'its'" }
            ];
            
            commonErrors.forEach(error => {
                if (error.pattern.test(text)) {
                    issues.push(error.message);
                }
            });
            
            const resultsArea = document.getElementById('writingResults');
            if (issues.length === 0) {
                resultsArea.innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> No grammar issues found. Your text looks good!</div>';
            } else {
                resultsArea.innerHTML = '<div class="text-warning"><i class="bi bi-exclamation-triangle"></i> Found ' + issues.length + ' potential grammar issue(s):</div><ul class="mt-2">' + 
                    issues.map(issue => `<li>${issue}</li>`).join('') + '</ul>';
            }
            showMessage('Grammar check completed');
        }
        
        function checkSpelling() {
            const text = textArea.value.toLowerCase();
            // Simple spell check simulation with common misspellings
            const commonMisspellings = {
                'recieve': 'receive',
                'seperate': 'separate',
                'definately': 'definitely',
                'occured': 'occurred',
                'occurence': 'occurrence',
                'truely': 'truly',
                'arguement': 'argument',
                'judgement': 'judgment',
                'maintainance': 'maintenance',
                'neccessary': 'necessary'
            };
            
            const foundErrors = [];
            Object.keys(commonMisspellings).forEach(misspelling => {
                if (text.includes(misspelling)) {
                    foundErrors.push({
                        word: misspelling,
                        suggestion: commonMisspellings[misspelling]
                    });
                }
            });
            
            const resultsArea = document.getElementById('writingResults');
            if (foundErrors.length === 0) {
                resultsArea.innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> No spelling errors found!</div>';
            } else {
                resultsArea.innerHTML = '<div class="text-warning"><i class="bi bi-exclamation-triangle"></i> Found ' + foundErrors.length + ' potential spelling error(s):</div><ul class="mt-2">' + 
                    foundErrors.map(error => `<li>"${error.word}" → "${error.suggestion}"</li>`).join('') + '</ul>';
            }
            showMessage('Spell check completed');
        }
        
        function rewriteText() {
            // Simple text rewriting simulation
            const synonyms = {
                'good': ['excellent', 'great', 'superb', 'outstanding'],
                'bad': ['poor', 'terrible', 'awful', 'substandard'],
                'important': ['crucial', 'vital', 'essential', 'significant'],
                'big': ['large', 'huge', 'enormous', 'massive'],
                'small': ['tiny', 'little', 'miniature', 'compact']
            };
            
            let newText = textArea.value;
            Object.keys(synonyms).forEach(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                const matches = newText.match(regex);
                if (matches) {
                    const randomSynonym = synonyms[word][Math.floor(Math.random() * synonyms[word].length)];
                    newText = newText.replace(regex, randomSynonym);
                }
            });
            
            document.getElementById('writingResults').innerHTML = `<div class="text-info"><i class="bi bi-arrow-repeat"></i> Rewritten text:</div><div class="mt-2">${newText}</div>`;
            showMessage('Text rewritten');
        }
        
        function paraphraseText() {
            // Simple paraphrasing simulation
            const text = textArea.value;
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            
            if (sentences.length === 0) {
                document.getElementById('writingResults').innerHTML = '<div class="text-warning">No sentences found to paraphrase</div>';
                return;
            }
            
            // Rearrange sentences
            const paraphrased = [...sentences].sort(() => Math.random() - 0.5).join(' ');
            
            document.getElementById('writingResults').innerHTML = `<div class="text-info"><i class="bi bi-chat-left-text"></i> Paraphrased text:</div><div class="mt-2">${paraphrased}</div>`;
            showMessage('Text paraphrased');
        }
        
        function improveContent() {
            const text = textArea.value;
            const suggestions = [];
            
            // Check for passive voice
            const passiveMatches = text.match(/\b(am|is|are|was|were|be|been|being)\s+\w+ed\b/gi);
            if (passiveMatches && passiveMatches.length > 3) {
                suggestions.push('Consider using more active voice. Found ' + passiveMatches.length + ' instances of passive voice.');
            }
            
            // Check sentence length
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            const longSentences = sentences.filter(s => s.split(/\s+/).length > 25);
            if (longSentences.length > 0) {
                suggestions.push('Consider breaking up long sentences. Found ' + longSentences.length + ' sentences with more than 25 words.');
            }
            
            // Check paragraph length
            const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim());
            const longParagraphs = paragraphs.filter(p => p.split(/\s+/).length > 150);
            if (longParagraphs.length > 0) {
                suggestions.push('Consider breaking up long paragraphs. Found ' + longParagraphs.length + ' paragraphs with more than 150 words.');
            }
            
            const resultsArea = document.getElementById('writingResults');
            if (suggestions.length === 0) {
                resultsArea.innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Your content is well-written!</div>';
            } else {
                resultsArea.innerHTML = '<div class="text-info"><i class="bi bi-lightning"></i> Content improvement suggestions:</div><ul class="mt-2">' + 
                    suggestions.map(suggestion => `<li>${suggestion}</li>`).join('') + '</ul>';
            }
            showMessage('Content improvement suggestions generated');
        }
        
        function simplifyText() {
            const text = textArea.value;
            // Simple text simplification simulation
            const complexWords = {
                'utilize': 'use',
                'facilitate': 'help',
                'implement': 'do',
                'approximately': 'about',
                'subsequently': 'later',
                'therefore': 'so',
                'nevertheless': 'but',
                'furthermore': 'also',
                'consequently': 'so',
                'accordingly': 'so'
            };
            
            let simplified = text;
            Object.keys(complexWords).forEach(complex => {
                const regex = new RegExp(`\\b${complex}\\b`, 'gi');
                simplified = simplified.replace(regex, complexWords[complex]);
            });
            
            document.getElementById('writingResults').innerHTML = `<div class="text-info"><i class="bi bi-file-text"></i> Simplified text:</div><div class="mt-2">${simplified}</div>`;
            showMessage('Text simplified');
        }
        
        function passiveToActive() {
            // Simple passive to active conversion simulation
            const text = textArea.value;
            // This is a simplified example
            const converted = text.replace(/\b(is|are|was|were)\s+(\w+ed)\s+by\s+(\w+)/gi, '$3 $2');
            
            document.getElementById('writingResults').innerHTML = `<div class="text-info"><i class="bi bi-arrow-right-circle"></i> Active voice conversion:</div><div class="mt-2">${converted}</div>`;
            showMessage('Converted passive to active voice');
        }
        
        function activeToPassive() {
            // Simple active to passive conversion simulation
            const text = textArea.value;
            // This is a simplified example
            const converted = text.replace(/(\w+)\s+(\w+ed)\s+(\w+)/gi, '$3 was $2 by $1');
            
            document.getElementById('writingResults').innerHTML = `<div class="text-info"><i class="bi bi-arrow-left-circle"></i> Passive voice conversion:</div><div class="mt-2">${converted}</div>`;
            showMessage('Converted active to passive voice');
        }
        
        function analyzeReadability() {
            const text = textArea.value;
            const words = text.trim() ? text.trim().split(/\s+/) : [];
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            const syllables = countSyllables(text);
            
            if (words.length === 0 || sentences.length === 0) {
                document.getElementById('writingResults').innerHTML = '<div class="text-warning">Not enough text to analyze readability</div>';
                return;
            }
            
            // Calculate Flesch Reading Ease score
            const wordsPerSentence = words.length / sentences.length;
            const syllablesPerWord = syllables / words.length;
            const fleschScore = 206.835 - (1.015 * wordsPerSentence) - (84.6 * syllablesPerWord);
            
            let readabilityLevel = '';
            if (fleschScore >= 90) readabilityLevel = 'Very Easy (5th grade)';
            else if (fleschScore >= 80) readabilityLevel = 'Easy (6th grade)';
            else if (fleschScore >= 70) readabilityLevel = 'Fairly Easy (7th grade)';
            else if (fleschScore >= 60) readabilityLevel = 'Standard (8th-9th grade)';
            else if (fleschScore >= 50) readabilityLevel = 'Fairly Difficult (10th-12th grade)';
            else if (fleschScore >= 30) readabilityLevel = 'Difficult (College)';
            else readabilityLevel = 'Very Difficult (College graduate)';
            
            document.getElementById('writingResults').innerHTML = `
                <div class="text-info"><i class="bi bi-graph-up"></i> Readability Analysis:</div>
                <div class="mt-2">
                    <strong>Flesch Reading Ease Score:</strong> ${fleschScore.toFixed(1)}<br>
                    <strong>Readability Level:</strong> ${readabilityLevel}<br>
                    <strong>Words per Sentence:</strong> ${wordsPerSentence.toFixed(1)}<br>
                    <strong>Syllables per Word:</strong> ${syllablesPerWord.toFixed(2)}
                </div>
            `;
            showMessage('Readability analysis completed');
        }
        
        function countSyllables(text) {
            // Simple syllable counting approximation
            const words = text.toLowerCase().match(/\b[a-z]+\b/g) || [];
            let syllableCount = 0;
            
            words.forEach(word => {
                // Remove silent 'e' at the end
                let wordWithoutSilentE = word.replace(/e$/, '');
                // Count vowel groups
                const vowelGroups = wordWithoutSilentE.match(/[aeiouy]+/g);
                syllableCount += vowelGroups ? vowelGroups.length : 1;
            });
            
            return syllableCount;
        }
        
        function analyzeTone() {
            const text = textArea.value.toLowerCase();
            const positiveWords = ['good', 'great', 'excellent', 'amazing', 'wonderful', 'happy', 'positive', 'success', 'love', 'like'];
            const negativeWords = ['bad', 'poor', 'terrible', 'awful', 'horrible', 'sad', 'negative', 'failure', 'hate', 'dislike'];
            
            let positiveCount = 0;
            let negativeCount = 0;
            
            positiveWords.forEach(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'g');
                const matches = text.match(regex);
                if (matches) positiveCount += matches.length;
            });
            
            negativeWords.forEach(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'g');
                const matches = text.match(regex);
                if (matches) negativeCount += matches.length;
            });
            
            let tone = 'Neutral';
            if (positiveCount > negativeCount * 2) tone = 'Very Positive';
            else if (positiveCount > negativeCount) tone = 'Positive';
            else if (negativeCount > positiveCount * 2) tone = 'Very Negative';
            else if (negativeCount > positiveCount) tone = 'Negative';
            
            document.getElementById('writingResults').innerHTML = `
                <div class="text-info"><i class="bi bi-emoji-smile"></i> Tone Analysis:</div>
                <div class="mt-2">
                    <strong>Overall Tone:</strong> ${tone}<br>
                    <strong>Positive Words:</strong> ${positiveCount}<br>
                    <strong>Negative Words:</strong> ${negativeCount}<br>
                    <strong>Sentiment Score:</strong> ${positiveCount - negativeCount}
                </div>
            `;
            showMessage('Tone analysis completed');
        }
        
        function checkPlagiarism() {
            // This is a simulation - real plagiarism check would require server-side processing
            document.getElementById('writingResults').innerHTML = `
                <div class="text-info"><i class="bi bi-shield-check"></i> Plagiarism Check Simulation:</div>
                <div class="mt-2">
                    <div class="text-success"><i class="bi bi-check-circle"></i> No exact matches found online</div>
                    <div class="text-warning mt-2"><i class="bi bi-exclamation-triangle"></i> Note: This is a simulation. For accurate plagiarism detection, use dedicated plagiarism checkers like Copyscape or Grammarly.</div>
                </div>
            `;
            showMessage('Plagiarism check completed (simulation)');
        }
        
        // SEO & CONTENT TOOLS
        function checkKeywordDensity() {
            const text = textArea.value.toLowerCase();
            const words = text.match(/\b[a-z]{3,}\b/g) || [];
            const wordCount = words.length;
            
            if (wordCount === 0) {
                document.getElementById('seoResults').innerHTML = '<div class="text-warning">No text to analyze</div>';
                return;
            }
            
            const frequencies = {};
            words.forEach(word => {
                frequencies[word] = (frequencies[word] || 0) + 1;
            });
            
            const sorted = Object.entries(frequencies).sort((a, b) => b[1] - a[1]);
            const topKeywords = sorted.slice(0, 15);
            
            let html = '<div class="text-info"><i class="bi bi-bar-chart"></i> Keyword Density Analysis:</div><table class="table table-sm mt-2"><thead><tr><th>Keyword</th><th>Count</th><th>Density</th></tr></thead><tbody>';
            
            topKeywords.forEach(([word, count]) => {
                const density = ((count / wordCount) * 100).toFixed(2);
                html += `<tr><td>${word}</td><td>${count}</td><td>${density}%</td></tr>`;
            });
            
            html += '</tbody></table>';
            
            // Check optimal keyword density
            const advice = [];
            topKeywords.forEach(([word, count]) => {
                const density = (count / wordCount) * 100;
                if (density > 3) {
                    advice.push(`"${word}" density (${density.toFixed(2)}%) is high. Consider reducing to 1-3%.`);
                } else if (density < 0.5 && count > 1) {
                    advice.push(`"${word}" density (${density.toFixed(2)}%) is low. Consider increasing if it's a focus keyword.`);
                }
            });
            
            if (advice.length > 0) {
                html += '<div class="text-warning mt-2"><strong>SEO Advice:</strong><ul class="mt-1">' + 
                    advice.map(item => `<li>${item}</li>`).join('') + '</ul></div>';
            }
            
            document.getElementById('seoResults').innerHTML = html;
            showMessage('Keyword density analysis completed');
        }
        
        function analyzeSEO() {
            const text = textArea.value;
            const titleMatch = text.match(/^#\s*(.+)$/m);
            const headings = text.match(/^#{1,6}\s*.+$/gm) || [];
            const words = text.trim() ? text.trim().split(/\s+/) : [];
            
            let html = '<div class="text-info"><i class="bi bi-search-heart"></i> SEO Content Analysis:</div><div class="mt-2">';
            
            // Check title
            if (titleMatch) {
                const title = titleMatch[1];
                html += `<strong>Title:</strong> ${title}<br>`;
                html += `<strong>Title Length:</strong> ${title.length} characters `;
                if (title.length >= 50 && title.length <= 60) {
                    html += '<span class="text-success">(Optimal)</span><br>';
                } else {
                    html += `<span class="text-warning">(${title.length < 50 ? 'Too short' : 'Too long'})</span><br>`;
                }
            } else {
                html += '<strong>Title:</strong> <span class="text-warning">No title found (add # at beginning)</span><br>';
            }
            
            // Check headings
            html += `<strong>Headings Found:</strong> ${headings.length}<br>`;
            if (headings.length === 0) {
                html += '<span class="text-warning">No headings found. Add H1-H6 headings for better SEO.</span><br>';
            } else {
                headings.forEach((heading, index) => {
                    const level = (heading.match(/^#+/)[0]).length;
                    html += `H${level}: ${heading.replace(/^#+\s*/, '')}<br>`;
                });
            }
            
            // Check content length
            html += `<strong>Content Length:</strong> ${words.length} words `;
            if (words.length >= 300) {
                html += '<span class="text-success">(Good for SEO)</span><br>';
            } else {
                html += `<span class="text-warning">(${words.length < 300 ? 'Consider adding more content' : 'Good'})</span><br>`;
            }
            
            // Check paragraph count
            const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim());
            html += `<strong>Paragraphs:</strong> ${paragraphs.length}<br>`;
            
            html += '</div>';
            
            document.getElementById('seoResults').innerHTML = html;
            showMessage('SEO analysis completed');
        }
        
        function findFocusKeyword() {
            const text = textArea.value.toLowerCase();
            const words = text.match(/\b[a-z]{3,}\b/g) || [];
            
            if (words.length === 0) {
                document.getElementById('seoResults').innerHTML = '<div class="text-warning">No text to analyze</div>';
                return;
            }
            
            const frequencies = {};
            words.forEach(word => {
                frequencies[word] = (frequencies[word] || 0) + 1;
            });
            
            const sorted = Object.entries(frequencies).sort((a, b) => b[1] - a[1]);
            const topKeywords = sorted.slice(0, 5);
            
            let html = '<div class="text-info"><i class="bi bi-bullseye"></i> Focus Keyword Suggestions:</div><div class="mt-2"><ul>';
            
            topKeywords.forEach(([word, count]) => {
                html += `<li><strong>${word}</strong> (appears ${count} times)`;
                
                // Check if it appears in title
                const titleMatch = text.match(/^#\s*(.+)$/m);
                if (titleMatch && titleMatch[1].toLowerCase().includes(word)) {
                    html += ' <span class="text-success">(in title)</span>';
                }
                
                // Check if it appears in first paragraph
                const firstParagraph = text.split(/\n\s*\n/)[0] || '';
                if (firstParagraph.toLowerCase().includes(word)) {
                    html += ' <span class="text-success">(in first paragraph)</span>';
                }
                
                html += '</li>';
            });
            
            html += '</ul></div>';
            
            document.getElementById('seoResults').innerHTML = html;
            showMessage('Focus keyword analysis completed');
        }
        
        function generateMetaDescription() {
            const text = textArea.value;
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            
            if (sentences.length === 0) {
                document.getElementById('seoResults').innerHTML = '<div class="text-warning">No text to generate description from</div>';
                return;
            }
            
            // Take first 2-3 sentences or create a summary
            let description = sentences.slice(0, 2).join(' ');
            
            // Trim to optimal length
            if (description.length > 160) {
                description = description.substring(0, 157) + '...';
            }
            
            document.getElementById('seoResults').innerHTML = `
                <div class="text-info"><i class="bi bi-card-text"></i> Meta Description:</div>
                <div class="mt-2">${description}</div>
                <div class="mt-2"><strong>Length:</strong> ${description.length} characters <span class="${description.length >= 120 && description.length <= 160 ? 'text-success' : 'text-warning'}">(${description.length < 120 ? 'Too short' : description.length > 160 ? 'Too long' : 'Optimal'})</span></div>
            `;
            showMessage('Meta description generated');
        }
        
        function generateTitle() {
            const text = textArea.value;
            const firstLine = text.split('\n')[0];
            
            // Extract first sentence or create title from first few words
            let title = firstLine.split(/[.!?]/)[0];
            
            if (title.length > 60) {
                title = title.substring(0, 57) + '...';
            } else if (title.length < 10) {
                // Use first few words from text
                const words = text.split(/\s+/).slice(0, 8).join(' ');
                title = words + (words.length < 50 ? ' - Text & Writing Tools' : '');
            }
            
            // Ensure title is capitalized
            title = title.charAt(0).toUpperCase() + title.slice(1);
            
            document.getElementById('seoResults').innerHTML = `
                <div class="text-info"><i class="bi bi-type-h1"></i> Title Suggestion:</div>
                <div class="mt-2">${title}</div>
                <div class="mt-2"><strong>Length:</strong> ${title.length} characters <span class="${title.length >= 50 && title.length <= 60 ? 'text-success' : 'text-warning'}">(${title.length < 50 ? 'Too short' : title.length > 60 ? 'Too long' : 'Optimal'})</span></div>
            `;
            showMessage('Title generated');
        }
        
        function generateSlug() {
            const text = textArea.value;
            const firstLine = text.split('\n')[0];
            
            // Create slug from first line
            let slug = firstLine
                .toLowerCase()
                .replace(/[^\w\s]/g, '') // Remove special characters
                .replace(/\s+/g, '-')    // Replace spaces with hyphens
                .substring(0, 50);       // Limit length
            
            // Remove trailing hyphen
            slug = slug.replace(/-$/, '');
            
            document.getElementById('seoResults').innerHTML = `
                <div class="text-info"><i class="bi bi-link-45deg"></i> URL Slug:</div>
                <div class="mt-2">${slug}</div>
                <div class="mt-2"><strong>Length:</strong> ${slug.length} characters</div>
            `;
            showMessage('URL slug generated');
        }
        
        // CLEANING TOOLS
        function removeDuplicateLines() {
            saveHistory();
            textArea.value = [...new Set(textArea.value.split('\n'))].join('\n');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Duplicate lines removed</div>';
            showMessage('Duplicate lines removed');
        }
        
        function sortLinesAsc() {
            saveHistory();
            textArea.value = textArea.value.split('\n').sort().join('\n');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Lines sorted A-Z</div>';
            showMessage('Lines sorted A-Z');
        }
        
        function sortLinesDesc() {
            saveHistory();
            textArea.value = textArea.value.split('\n').sort().reverse().join('\n');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Lines sorted Z-A</div>';
            showMessage('Lines sorted Z-A');
        }
        
        function reverseLines() {
            saveHistory();
            textArea.value = textArea.value.split('\n').reverse().join('\n');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Lines reversed</div>';
            showMessage('Lines reversed');
        }
        
        function removeSpecialChars() {
            saveHistory();
            textArea.value = textArea.value.replace(/[^\w\s\n.,!?;:'"-]/g, '');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Special characters removed</div>';
            showMessage('Special characters removed');
        }
        
        function removeNumbers() {
            saveHistory();
            textArea.value = textArea.value.replace(/\d+/g, '');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Numbers removed</div>';
            showMessage('Numbers removed');
        }
        
        function removePunctuation() {
            saveHistory();
            textArea.value = textArea.value.replace(/[.,!?;:'"-]/g, '');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Punctuation removed</div>';
            showMessage('Punctuation removed');
        }
        
        function removeEmojis() {
            saveHistory();
            textArea.value = textArea.value.replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F1E0}-\u{1F1FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu, '');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Emojis removed</div>';
            showMessage('Emojis removed');
        }
        
        function extractNumbers() {
            const numbers = textArea.value.match(/\d+/g) || [];
            document.getElementById('cleaningResults').innerHTML = `
                <div class="text-info"><i class="bi bi-123"></i> Extracted Numbers:</div>
                <div class="mt-2">${numbers.join(', ')}</div>
                <div class="mt-2"><strong>Count:</strong> ${numbers.length}</div>
            `;
            showMessage('Numbers extracted');
        }
        
        function extractEmails() {
            const emails = textArea.value.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g) || [];
            document.getElementById('cleaningResults').innerHTML = `
                <div class="text-info"><i class="bi bi-envelope"></i> Extracted Emails:</div>
                <div class="mt-2">${emails.join('<br>')}</div>
                <div class="mt-2"><strong>Count:</strong> ${emails.length}</div>
            `;
            showMessage('Emails extracted');
        }
        
        function extractURLs() {
            const urls = textArea.value.match(/https?:\/\/[^\s]+/g) || [];
            document.getElementById('cleaningResults').innerHTML = `
                <div class="text-info"><i class="bi bi-link-45deg"></i> Extracted URLs:</div>
                <div class="mt-2">${urls.join('<br>')}</div>
                <div class="mt-2"><strong>Count:</strong> ${urls.length}</div>
            `;
            showMessage('URLs extracted');
        }
        
        function extractHashtags() {
            const hashtags = textArea.value.match(/#\w+/g) || [];
            document.getElementById('cleaningResults').innerHTML = `
                <div class="text-info"><i class="bi bi-hash"></i> Extracted Hashtags:</div>
                <div class="mt-2">${hashtags.join(', ')}</div>
                <div class="mt-2"><strong>Count:</strong> ${hashtags.length}</div>
            `;
            showMessage('Hashtags extracted');
        }
        
        function reverseText() {
            saveHistory();
            textArea.value = textArea.value.split('').reverse().join('');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Text reversed</div>';
            showMessage('Text reversed');
        }
        
        function shuffleLines() {
            saveHistory();
            const lines = textArea.value.split('\n');
            for (let i = lines.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [lines[i], lines[j]] = [lines[j], lines[i]];
            }
            textArea.value = lines.join('\n');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Lines shuffled</div>';
            showMessage('Lines shuffled');
        }
        
        function mergeLines() {
            saveHistory();
            textArea.value = textArea.value.split('\n').join(' ');
            analyze();
            document.getElementById('cleaningResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Lines merged</div>';
            showMessage('Lines merged');
        }
        
        function splitIntoSentences() {
            saveHistory();
            const sentences = textArea.value.match(/[^.!?]+[.!?]+/g) || [];
            textArea.value = sentences.join('\n');
            analyze();
            document.getElementById('cleaningResults').innerHTML = `
                <div class="text-success"><i class="bi bi-check-circle"></i> Text split into sentences</div>
                <div class="mt-2"><strong>Sentences:</strong> ${sentences.length}</div>
            `;
            showMessage('Text split into sentences');
        }
        
        // DEVELOPER TOOLS
        function formatJSON() {
            const input = document.getElementById('converterInput').value || textArea.value;
            try {
                const parsed = JSON.parse(input);
                const formatted = JSON.stringify(parsed, null, 2);
                document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> JSON formatted successfully</div><pre class="code-area mt-2">${escapeHtml(formatted)}</pre>`;
                document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(formatted)}</pre>`;
                showMessage('JSON formatted');
            } catch (e) {
                document.getElementById('devResults').innerHTML = `<div class="text-danger"><i class="bi bi-exclamation-triangle"></i> Invalid JSON: ${e.message}</div>`;
                showMessage('Invalid JSON');
            }
        }
        
        function formatXML() {
            const input = document.getElementById('converterInput').value || textArea.value;
            try {
                // Simple XML formatting (for demonstration)
                let formatted = '';
                let indent = 0;
                const lines = input.split(/(>|<)/);
                
                lines.forEach(line => {
                    if (line.startsWith('</')) {
                        indent--;
                    }
                    
                    formatted += '  '.repeat(Math.max(0, indent)) + line + '\n';
                    
                    if (line.startsWith('<') && !line.startsWith('</') && !line.endsWith('/>')) {
                        indent++;
                    }
                });
                
                document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> XML formatted</div><pre class="code-area mt-2">${escapeHtml(formatted)}</pre>`;
                document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(formatted)}</pre>`;
                showMessage('XML formatted');
            } catch (e) {
                document.getElementById('devResults').innerHTML = `<div class="text-danger"><i class="bi bi-exclamation-triangle"></i> Error formatting XML</div>`;
                showMessage('Error formatting XML');
            }
        }
        
        function minifyHTML() {
            const input = document.getElementById('converterInput').value || textArea.value;
            const minified = input
                .replace(/\s+/g, ' ')
                .replace(/>\s+</g, '><')
                .trim();
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> HTML minified</div><pre class="code-area mt-2">${escapeHtml(minified)}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(minified)}</pre>`;
            showMessage('HTML minified');
        }
        
        function beautifyHTML() {
            const input = document.getElementById('converterInput').value || textArea.value;
            // Simple HTML beautifying
            let beautified = input
                .replace(/>\s+</g, '>\n<')
                .replace(/\s+/g, ' ')
                .replace(/ {2,}/g, ' ')
                .trim();
            
            // Add indentation
            let indent = 0;
            const lines = beautified.split('\n');
            beautified = lines.map(line => {
                if (line.includes('</')) indent--;
                const indentedLine = '  '.repeat(Math.max(0, indent)) + line.trim();
                if (line.includes('<') && !line.includes('</') && !line.includes('/>')) indent++;
                return indentedLine;
            }).join('\n');
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> HTML beautified</div><pre class="code-area mt-2">${escapeHtml(beautified)}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(beautified)}</pre>`;
            showMessage('HTML beautified');
        }
        
        function minifyCSS() {
            const input = document.getElementById('converterInput').value || textArea.value;
            const minified = input
                .replace(/\/\*[\s\S]*?\*\//g, '') // Remove comments
                .replace(/\s+/g, ' ')
                .replace(/;\s+/g, ';')
                .replace(/:\s+/g, ':')
                .replace(/\s*{\s*/g, '{')
                .replace(/\s*}\s*/g, '}')
                .trim();
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> CSS minified</div><pre class="code-area mt-2">${escapeHtml(minified)}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(minified)}</pre>`;
            showMessage('CSS minified');
        }
        
        function minifyJS() {
            const input = document.getElementById('converterInput').value || textArea.value;
            const minified = input
                .replace(/\/\/.*$/gm, '') // Remove single-line comments
                .replace(/\/\*[\s\S]*?\*\//g, '') // Remove multi-line comments
                .replace(/\s+/g, ' ')
                .replace(/\s*([=+\-*/%&|^!<>?:;,])\s*/g, '$1')
                .trim();
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> JavaScript minified</div><pre class="code-area mt-2">${escapeHtml(minified)}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(minified)}</pre>`;
            showMessage('JavaScript minified');
        }
        
        function validateJSON() {
            const input = document.getElementById('converterInput').value || textArea.value;
            try {
                JSON.parse(input);
                document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> Valid JSON</div>`;
                showMessage('Valid JSON');
            } catch (e) {
                document.getElementById('devResults').innerHTML = `<div class="text-danger"><i class="bi bi-exclamation-triangle"></i> Invalid JSON: ${e.message}</div>`;
                showMessage('Invalid JSON');
            }
        }
        
        function validateXML() {
            const input = document.getElementById('converterInput').value || textArea.value;
            // Simple XML validation
            const hasRoot = /<[^/>]+>[\s\S]*<\/[^>]+>/.test(input);
            const tagsMatch = (input.match(/<[^\/][^>]*>/g) || []).length === (input.match(/<\/[^>]+>/g) || []).length;
            
            if (hasRoot && tagsMatch) {
                document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> XML appears to be well-formed</div>`;
                showMessage('XML appears valid');
            } else {
                document.getElementById('devResults').innerHTML = `<div class="text-danger"><i class="bi bi-exclamation-triangle"></i> XML may not be well-formed</div>`;
                showMessage('XML may be invalid');
            }
        }
        
        function codeToText() {
            const input = document.getElementById('converterInput').value || textArea.value;
            // Convert code to plain text by removing special characters
            const text = input
                .replace(/[{}[\]()<>]/g, ' ')
                .replace(/[^\w\s.,!?;:'"-]/g, '')
                .replace(/\s+/g, ' ')
                .trim();
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> Code converted to text</div><div class="mt-2">${text}</div>`;
            document.getElementById('converterOutput').innerHTML = text;
            showMessage('Code converted to text');
        }
        
        function textToCode() {
            const input = document.getElementById('converterInput').value || textArea.value;
            // Convert text to code-like format
            const code = `// Generated from text\nconst text = \`${input}\`;\n\nconsole.log(text);`;
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> Text converted to code</div><pre class="code-area mt-2">${escapeHtml(code)}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(code)}</pre>`;
            showMessage('Text converted to code');
        }
        
        function htmlToMarkdown() {
            const input = document.getElementById('converterInput').value || textArea.value;
            // Simple HTML to Markdown conversion
            let markdown = input
                .replace(/<h1[^>]*>(.*?)<\/h1>/gi, '# $1\n')
                .replace(/<h2[^>]*>(.*?)<\/h2>/gi, '## $1\n')
                .replace(/<h3[^>]*>(.*?)<\/h3>/gi, '### $1\n')
                .replace(/<p[^>]*>(.*?)<\/p>/gi, '$1\n\n')
                .replace(/<a[^>]*href="([^"]*)"[^>]*>(.*?)<\/a>/gi, '[$2]($1)')
                .replace(/<strong[^>]*>(.*?)<\/strong>/gi, '**$1**')
                .replace(/<em[^>]*>(.*?)<\/em>/gi, '*$1*')
                .replace(/<[^>]+>/g, '') // Remove remaining tags
                .replace(/&lt;/g, '<')
                .replace(/&gt;/g, '>')
                .replace(/&amp;/g, '&')
                .trim();
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> HTML converted to Markdown</div><pre class="code-area mt-2">${escapeHtml(markdown)}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(markdown)}</pre>`;
            showMessage('HTML converted to Markdown');
        }
        
        function markdownToHTML() {
            const input = document.getElementById('converterInput').value || textArea.value;
            // Simple Markdown to HTML conversion
            let html = input
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2">$1</a>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code>$1</code>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            // Wrap in paragraph if not already wrapped
            if (!html.startsWith('<h') && !html.startsWith('<p>')) {
                html = '<p>' + html + '</p>';
            }
            
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> Markdown converted to HTML</div><pre class="code-area mt-2">${escapeHtml(html)}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(html)}</pre>`;
            showMessage('Markdown converted to HTML');
        }
        
        function encodeBase64() {
            const input = document.getElementById('converterInput').value || textArea.value;
            const encoded = btoa(unescape(encodeURIComponent(input)));
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> Base64 encoded</div><pre class="code-area mt-2">${encoded}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${encoded}</pre>`;
            showMessage('Base64 encoded');
        }
        
        function decodeBase64() {
            const input = document.getElementById('converterInput').value || textArea.value;
            try {
                const decoded = decodeURIComponent(escape(atob(input)));
                document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> Base64 decoded</div><pre class="code-area mt-2">${escapeHtml(decoded)}</pre>`;
                document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(decoded)}</pre>`;
                showMessage('Base64 decoded');
            } catch (e) {
                document.getElementById('devResults').innerHTML = `<div class="text-danger"><i class="bi bi-exclamation-triangle"></i> Invalid Base64</div>`;
                showMessage('Invalid Base64');
            }
        }
        
        function encodeURL() {
            const input = document.getElementById('converterInput').value || textArea.value;
            const encoded = encodeURIComponent(input);
            document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> URL encoded</div><pre class="code-area mt-2">${encoded}</pre>`;
            document.getElementById('converterOutput').innerHTML = `<pre>${encoded}</pre>`;
            showMessage('URL encoded');
        }
        
        function decodeURL() {
            const input = document.getElementById('converterInput').value || textArea.value;
            try {
                const decoded = decodeURIComponent(input);
                document.getElementById('devResults').innerHTML = `<div class="text-success"><i class="bi bi-check-circle"></i> URL decoded</div><pre class="code-area mt-2">${escapeHtml(decoded)}</pre>`;
                document.getElementById('converterOutput').innerHTML = `<pre>${escapeHtml(decoded)}</pre>`;
                showMessage('URL decoded');
            } catch (e) {
                document.getElementById('devResults').innerHTML = `<div class="text-danger"><i class="bi bi-exclamation-triangle"></i> Invalid URL encoding</div>`;
                showMessage('Invalid URL encoding');
            }
        }
        
        // CONVERTER TOOLS
        function textToPDF() {
            // Open print dialog for PDF generation
            window.print();
            showMessage('PDF generated (use print to save as PDF)');
        }
        
        function pdfToText() {
            document.getElementById('converterOutput').innerHTML = '<div class="text-warning">PDF to Text conversion requires server-side processing. Please use a dedicated PDF to Text converter.</div>';
            showMessage('PDF to Text requires server processing');
        }
        
        function textToImage() {
            const text = document.getElementById('converterInput').value || textArea.value;
            if (!text.trim()) {
                document.getElementById('converterOutput').innerHTML = '<div class="text-warning">No text to convert</div>';
                return;
            }
            
            // Create a temporary canvas
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 800;
            canvas.height = 400;
            
            // Draw background
            ctx.fillStyle = document.documentElement.classList.contains('dark') ? '#1e293b' : '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw text
            ctx.fillStyle = document.documentElement.classList.contains('dark') ? '#e5e7eb' : '#000000';
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';
            
            // Wrap text
            const lines = [];
            const maxWidth = 700;
            const words = text.split(' ');
            let line = '';
            
            for (let i = 0; i < words.length; i++) {
                const testLine = line + words[i] + ' ';
                const metrics = ctx.measureText(testLine);
                
                if (metrics.width > maxWidth && i > 0) {
                    lines.push(line);
                    line = words[i] + ' ';
                } else {
                    line = testLine;
                }
            }
            lines.push(line);
            
            // Draw lines
            const lineHeight = 30;
            const startY = 50;
            
            lines.forEach((line, index) => {
                if (index < 10) { // Limit to 10 lines
                    ctx.fillText(line.trim(), canvas.width / 2, startY + (index * lineHeight));
                }
            });
            
            // Add watermark
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.font = '40px Arial';
            ctx.fillText('Text Tools Pro+', canvas.width / 2, canvas.height - 50);
            
            // Save as image
            const img = canvas.toDataURL('image/png');
            document.getElementById('converterOutput').innerHTML = `<div class="text-success">Image generated</div><img src="${img}" alt="Text as Image" class="img-fluid mt-2">`;
            showMessage('Text converted to image');
        }
        
        function imageToText() {
            document.getElementById('converterOutput').innerHTML = '<div class="text-warning">Image to Text (OCR) requires server-side processing. Please use a dedicated OCR tool.</div>';
            showMessage('OCR requires server processing');
        }
        
        function textToSpeech() {
            const text = document.getElementById('converterInput').value || textArea.value;
            if (!text.trim()) {
                showMessage('No text to speak');
                return;
            }
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 1;
                utterance.pitch = 1;
                utterance.volume = 1;
                
                speechSynthesis.speak(utterance);
                document.getElementById('converterOutput').innerHTML = '<div class="text-success">Speaking text... <button class="btn btn-sm btn-danger" onclick="window.speechSynthesis.cancel()">Stop</button></div>';
                showMessage('Speaking text');
            } else {
                document.getElementById('converterOutput').innerHTML = '<div class="text-danger">Text-to-speech not supported in this browser</div>';
                showMessage('Text-to-speech not supported');
            }
        }
        
        function speechToText() {
            document.getElementById('converterOutput').innerHTML = '<div class="text-warning">Speech to Text requires browser microphone permissions and Web Speech API support.</div>';
            showMessage('Speech to Text requires microphone access');
        }
        
        function markdownToHTMLConv() {
            markdownToHTML();
        }
        
        function htmlToMarkdownConv() {
            htmlToMarkdown();
        }
        
        function textToCSV() {
            const text = document.getElementById('converterInput').value || textArea.value;
            const lines = text.split('\n');
            const csv = lines.map(line => {
                // Escape commas and quotes
                if (line.includes(',') || line.includes('"')) {
                    return '"' + line.replace(/"/g, '""') + '"';
                }
                return line;
            }).join('\n');
            
            document.getElementById('converterOutput').innerHTML = `<div class="text-success">Text converted to CSV</div><pre class="code-area mt-2">${escapeHtml(csv)}</pre>`;
            showMessage('Text converted to CSV');
        }
        
        function csvToText() {
            const csv = document.getElementById('converterInput').value || textArea.value;
            // Simple CSV to text conversion
            const lines = csv.split('\n');
            const text = lines.map(line => {
                // Remove quotes and handle CSV escaping
                return line.replace(/^"|"$/g, '').replace(/""/g, '"');
            }).join('\n');
            
            document.getElementById('converterOutput').innerHTML = `<div class="text-success">CSV converted to text</div><pre class="mt-2">${escapeHtml(text)}</pre>`;
            showMessage('CSV converted to text');
        }
        
        function textToBinary() {
            const text = document.getElementById('converterInput').value || textArea.value;
            let binary = '';
            for (let i = 0; i < text.length; i++) {
                const charCode = text.charCodeAt(i);
                binary += charCode.toString(2).padStart(8, '0') + ' ';
            }
            document.getElementById('converterOutput').innerHTML = `<div class="text-success">Text converted to binary</div><pre class="code-area mt-2">${binary.trim()}</pre>`;
            showMessage('Text converted to binary');
        }
        
        function binaryToText() {
            const binary = document.getElementById('converterInput').value || textArea.value;
            const binaryArray = binary.split(' ').filter(b => b);
            let text = '';
            
            for (let i = 0; i < binaryArray.length; i++) {
                const charCode = parseInt(binaryArray[i], 2);
                if (!isNaN(charCode)) {
                    text += String.fromCharCode(charCode);
                }
            }
            
            document.getElementById('converterOutput').innerHTML = `<div class="text-success">Binary converted to text</div><pre class="mt-2">${escapeHtml(text)}</pre>`;
            showMessage('Binary converted to text');
        }
        
        function textToHex() {
            const text = document.getElementById('converterInput').value || textArea.value;
            let hex = '';
            for (let i = 0; i < text.length; i++) {
                hex += text.charCodeAt(i).toString(16).padStart(2, '0') + ' ';
            }
            document.getElementById('converterOutput').innerHTML = `<div class="text-success">Text converted to hex</div><pre class="code-area mt-2">${hex.trim()}</pre>`;
            showMessage('Text converted to hex');
        }
        
        function hexToText() {
            const hex = document.getElementById('converterInput').value || textArea.value;
            const hexArray = hex.split(' ').filter(h => h);
            let text = '';
            
            for (let i = 0; i < hexArray.length; i++) {
                const charCode = parseInt(hexArray[i], 16);
                if (!isNaN(charCode)) {
                    text += String.fromCharCode(charCode);
                }
            }
            
            document.getElementById('converterOutput').innerHTML = `<div class="text-success">Hex converted to text</div><pre class="mt-2">${escapeHtml(text)}</pre>`;
            showMessage('Hex converted to text');
        }
        
        // ADVANCED FEATURES
        function optimizeHeadings() {
            const text = textArea.value;
            // Simple heading optimization
            let optimized = text.replace(/^(#{1,6})\s*(.+)$/gm, function(match, hashes, content) {
                // Ensure proper spacing after hashes
                return `${hashes} ${content.trim()}`;
            });
            
            // Check for heading hierarchy
            const headings = optimized.match(/^(#{1,6})\s*.+$/gm) || [];
            let lastLevel = 0;
            let hierarchyOk = true;
            
            for (let heading of headings) {
                const level = heading.match(/^#+/)[0].length;
                if (level > lastLevel + 1) {
                    hierarchyOk = false;
                    break;
                }
                lastLevel = level;
            }
            
            if (!hierarchyOk) {
                showMessage('Heading hierarchy may need adjustment (skip heading levels)');
            }
            
            document.getElementById('seoResults').innerHTML = `
                <div class="text-info"><i class="bi bi-type-h1"></i> Headings Optimized:</div>
                <div class="mt-2"><pre>${escapeHtml(optimized)}</pre></div>
                <div class="mt-2">${hierarchyOk ? '<span class="text-success">Heading hierarchy is good</span>' : '<span class="text-warning">Heading hierarchy may need adjustment</span>'}</div>
            `;
            showMessage('Headings optimized');
        }
        
        function addInternalLinks() {
            const text = textArea.value;
            // Simple internal link suggestion
            const words = text.toLowerCase().match(/\b[a-z]{6,}\b/g) || [];
            const frequencies = {};
            
            words.forEach(word => {
                frequencies[word] = (frequencies[word] || 0) + 1;
            });
            
            const topWords = Object.entries(frequencies)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .map(([word]) => word);
            
            let suggestions = '<div class="text-info"><i class="bi bi-link"></i> Internal Link Suggestions:</div><div class="mt-2">Consider adding internal links for these frequently mentioned terms:</div><ul class="mt-2">';
            
            topWords.forEach(word => {
                suggestions += `<li>${word} (mentioned ${frequencies[word]} times)</li>`;
            });
            
            suggestions += '</ul>';
            
            document.getElementById('seoResults').innerHTML = suggestions;
            showMessage('Internal link suggestions generated');
        }
        
        function generateFAQ() {
            const text = textArea.value;
            const questions = text.match(/[^.!?]+\?/g) || [];
            
            if (questions.length === 0) {
                document.getElementById('seoResults').innerHTML = '<div class="text-warning">No questions found in text</div>';
                return;
            }
            
            let faq = '<div class="text-info"><i class="bi bi-question-circle"></i> FAQ Suggestions:</div><div class="mt-2">';
            
            questions.slice(0, 5).forEach((question, index) => {
                faq += `<div class="mb-2"><strong>Q${index + 1}:</strong> ${question.trim()}</div>`;
            });
            
            faq += '</div>';
            
            document.getElementById('seoResults').innerHTML = faq;
            showMessage('FAQ suggestions generated');
        }
        
        function calculateContentScore() {
            const text = textArea.value;
            const words = text.trim() ? text.trim().split(/\s+/) : [];
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim());
            const headings = text.match(/^#{1,6}\s*.+$/gm) || [];
            
            let score = 0;
            let maxScore = 100;
            let feedback = [];
            
            // Word count (max 20 points)
            if (words.length >= 300) score += 20;
            else if (words.length >= 200) score += 15;
            else if (words.length >= 100) score += 10;
            else if (words.length >= 50) score += 5;
            else feedback.push('Content is very short. Aim for at least 300 words.');
            
            // Sentence length variety (max 20 points)
            const sentenceLengths = sentences.map(s => s.split(/\s+/).length);
            const avgSentenceLength = sentenceLengths.reduce((a, b) => a + b, 0) / sentences.length || 0;
            
            if (avgSentenceLength >= 15 && avgSentenceLength <= 25) score += 20;
            else if (avgSentenceLength >= 10 && avgSentenceLength <= 30) score += 15;
            else if (avgSentenceLength >= 5 && avgSentenceLength <= 40) score += 10;
            else feedback.push('Sentence length may need adjustment. Aim for 15-25 words per sentence on average.');
            
            // Headings (max 20 points)
            if (headings.length >= 3) score += 20;
            else if (headings.length >= 2) score += 15;
            else if (headings.length >= 1) score += 10;
            else feedback.push('Add headings to improve structure and SEO.');
            
            // Paragraphs (max 20 points)
            if (paragraphs.length >= 3) score += 20;
            else if (paragraphs.length >= 2) score += 15;
            else if (paragraphs.length >= 1) score += 10;
            else feedback.push('Break content into paragraphs for better readability.');
            
            // Readability (max 20 points - estimated)
            const syllables = countSyllables(text);
            const wordsPerSentence = words.length / (sentences.length || 1);
            const syllablesPerWord = syllables / (words.length || 1);
            const fleschScore = 206.835 - (1.015 * wordsPerSentence) - (84.6 * syllablesPerWord);
            
            if (fleschScore >= 60) score += 20;
            else if (fleschScore >= 50) score += 15;
            else if (fleschScore >= 40) score += 10;
            else feedback.push('Content may be difficult to read. Consider simplifying complex sentences.');
            
            document.getElementById('seoResults').innerHTML = `
                <div class="text-info"><i class="bi bi-star"></i> Content Score: ${score}/${maxScore}</div>
                <div class="mt-2">
                    <div class="progress" style="height: 20px;">
                        <div class="progress-bar ${score >= 70 ? 'bg-success' : score >= 40 ? 'bg-warning' : 'bg-danger'}" role="progressbar" style="width: ${(score/maxScore)*100}%"></div>
                    </div>
                    <div class="mt-2"><strong>Breakdown:</strong></div>
                    <ul class="mt-1">
                        <li>Word Count: ${words.length} words</li>
                        <li>Sentences: ${sentences.length}</li>
                        <li>Paragraphs: ${paragraphs.length}</li>
                        <li>Headings: ${headings.length}</li>
                        <li>Readability Score: ${fleschScore.toFixed(1)}</li>
                    </ul>
                    ${feedback.length > 0 ? `<div class="mt-2"><strong>Suggestions:</strong><ul class="mt-1">${feedback.map(f => `<li>${f}</li>`).join('')}</ul></div>` : ''}
                </div>
            `;
            showMessage('Content score calculated');
        }
        
        function checkReadabilityScore() {
            analyzeReadability();
        }
        
        function analyzeEngagement() {
            const text = textArea.value;
            const questions = (text.match(/\?/g) || []).length;
            const exclamations = (text.match(/!/g) || []).length;
            const youCount = (text.match(/\byou\b/gi) || []).length;
            const weCount = (text.match(/\bwe\b|\bus\b/gi) || []).length;
            const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
            
            // Calculate engagement score
            let engagementScore = 0;
            if (wordCount > 0) {
                engagementScore += Math.min(30, (questions / wordCount) * 10000);
                engagementScore += Math.min(30, (exclamations / wordCount) * 10000);
                engagementScore += Math.min(20, (youCount / wordCount) * 5000);
                engagementScore += Math.min(20, (weCount / wordCount) * 5000);
            }
            
            engagementScore = Math.min(100, Math.round(engagementScore));
            
            document.getElementById('seoResults').innerHTML = `
                <div class="text-info"><i class="bi bi-people"></i> Engagement Analysis:</div>
                <div class="mt-2">
                    <div class="progress" style="height: 20px;">
                        <div class="progress-bar ${engagementScore >= 70 ? 'bg-success' : engagementScore >= 40 ? 'bg-warning' : 'bg-danger'}" role="progressbar" style="width: ${engagementScore}%"></div>
                    </div>
                    <div class="mt-2"><strong>Engagement Score:</strong> ${engagementScore}/100</div>
                    <div class="mt-2"><strong>Breakdown:</strong></div>
                    <ul class="mt-1">
                        <li>Questions: ${questions}</li>
                        <li>Exclamations: ${exclamations}</li>
                        <li>Direct references ("you"): ${youCount}</li>
                        <li>Inclusive language ("we/us"): ${weCount}</li>
                    </ul>
                    <div class="mt-2"><strong>Tips to improve engagement:</strong></div>
                    <ul class="mt-1">
                        <li>Ask questions to involve readers</li>
                        <li>Use inclusive language (we, us, our)</li>
                        <li>Address the reader directly (you, your)</li>
                        <li>Use exclamations sparingly for emphasis</li>
                    </ul>
                </div>
            `;
            showMessage('Engagement analysis completed');
        }
        
        function autoCorrect() {
            saveHistory();
            let text = textArea.value;
            
            // Common autocorrect fixes
            const corrections = {
                'teh': 'the',
                'adn': 'and',
                'thier': 'their',
                'recieve': 'receive',
                'seperate': 'separate',
                'occured': 'occurred',
                'definately': 'definitely',
                'wich': 'which',
                'tounge': 'tongue',
                'alot': 'a lot',
                'seperate': 'separate'
            };
            
            Object.keys(corrections).forEach(wrong => {
                const regex = new RegExp(`\\b${wrong}\\b`, 'gi');
                text = text.replace(regex, corrections[wrong]);
            });
            
            textArea.value = text;
            analyze();
            document.getElementById('writingResults').innerHTML = '<div class="text-success"><i class="bi bi-check-circle"></i> Auto-correct applied</div>';
            showMessage('Auto-correct applied');
        }
        
        // Word cloud functions
        function generateWordCloud() {
            const text = textArea.value.toLowerCase();
            if (!text.trim()) {
                showMessage('No text to generate word cloud');
                return;
            }
            
            const words = text.match(/\b[a-z]{4,}\b/g) || [];
            if (words.length === 0) {
                showMessage('No words long enough for word cloud');
                return;
            }
            
            // Count word frequencies
            const frequencies = {};
            words.forEach(word => {
                frequencies[word] = (frequencies[word] || 0) + 1;
            });
            
            // Sort by frequency and take top 50
            wordCloudData = Object.entries(frequencies)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 50);
            
            displayWordCloud();
            wordCloudModalInstance.show();
        }
        
        function displayWordCloud() {
            const container = document.getElementById('wordCloud');
            container.innerHTML = '';
            
            if (wordCloudData.length === 0) {
                container.innerHTML = '<div class="text-center text-muted">No words to display</div>';
                return;
            }
            
            const maxCount = wordCloudData[0][1];
            
            wordCloudData.forEach(([word, count]) => {
                const size = 16 + (count / maxCount) * 32;
                const color = getRandomColor();
                const opacity = 0.5 + (count / maxCount) * 0.5;
                const rotation = Math.random() * 30 - 15;
                
                const span = document.createElement('span');
                span.textContent = word;
                span.style.fontSize = `${size}px`;
                span.style.color = color;
                span.style.opacity = opacity;
                span.style.transform = `rotate(${rotation}deg)`;
                span.style.display = 'inline-block';
                span.style.margin = '5px';
                span.style.padding = '2px 5px';
                span.style.cursor = 'pointer';
                span.title = `Frequency: ${count}`;
                span.onclick = () => {
                    document.getElementById('findText').value = word;
                    findNext();
                };
                
                container.appendChild(span);
            });
        }
        
        function getRandomColor() {
            const colors = ['#4a6bff', '#28a745', '#ffc107', '#dc3545', '#6f42c1', '#20c997', '#fd7e14', '#e83e8c'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        function regenerateWordCloud() {
            displayWordCloud();
            showMessage('Word cloud regenerated');
        }
        
        function saveWordCloud() {
            // Create a temporary canvas
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 800;
            canvas.height = 400;
            
            // Draw background
            ctx.fillStyle = document.documentElement.classList.contains('dark') ? '#1e293b' : '#f8f9fd';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            if (wordCloudData.length === 0) {
                showMessage('No word cloud data to save');
                return;
            }
            
            const maxCount = wordCloudData[0][1];
            
            // Draw words
            wordCloudData.forEach(([word, count], index) => {
                const size = 16 + (count / maxCount) * 32;
                const color = getRandomColor();
                const opacity = 0.5 + (count / maxCount) * 0.5;
                
                ctx.font = `${size}px Arial`;
                ctx.fillStyle = color;
                ctx.globalAlpha = opacity;
                
                // Simple grid layout
                const x = 50 + (index % 10) * 70;
                const y = 50 + Math.floor(index / 10) * 50;
                
                ctx.fillText(word, x, y);
                ctx.globalAlpha = 1;
            });
            
            // Save as image
            const link = document.createElement('a');
            link.download = 'word-cloud.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
            showMessage('Word cloud saved as image');
        }
        
        // Import/Export functions
        function openImportModal() {
            importModal.show();
        }
        
        function importFromFile() {
            document.getElementById('fileInput').click();
        }
        
        function importFromURL() {
            const url = prompt('Enter URL to import from:', 'https://');
            if (url) {
                fetch(url)
                    .then(response => {
                        if (!response.ok) throw new Error('Network response was not ok');
                        return response.text();
                    })
                    .then(text => {
                        saveHistory();
                        textArea.value = text;
                        analyze();
                        importModal.hide();
                        showMessage('Text imported from URL');
                    })
                    .catch(error => {
                        showMessage('Failed to import from URL: ' + error.message);
                    });
            }
        }
        
        function importFromClipboard() {
            navigator.clipboard.readText()
                .then(text => {
                    saveHistory();
                    textArea.value = text;
                    analyze();
                    showMessage('Text imported from clipboard');
                })
                .catch(error => {
                    showMessage('Failed to read clipboard: ' + error.message);
                });
        }
        
        function processImport() {
            // Check direct input first
            const directInput = document.getElementById('directInput').value;
            if (directInput) {
                saveHistory();
                textArea.value = directInput;
                analyze();
                importModal.hide();
                showMessage('Text imported from input');
                return;
            }
            
            // Check URL input
            const urlInput = document.getElementById('urlInput').value;
            if (urlInput) {
                importFromURL();
                return;
            }
            
            showMessage('Please select an import method');
        }
        
        function readFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                saveHistory();
                textArea.value = e.target.result;
                analyze();
                importModal.hide();
                showMessage(`Imported from ${file.name}`);
            };
            reader.onerror = function() {
                showMessage('Failed to read file');
            };
            reader.readAsText(file);
        }
        
        function exportAllData() {
            const data = {
                text: textArea.value,
                stats: {
                    words: document.getElementById('words').textContent,
                    characters: document.getElementById('chars').textContent,
                    sentences: document.getElementById('sentences').textContent,
                    paragraphs: document.getElementById('paras').textContent,
                    uniqueWords: document.getElementById('unique').textContent,
                    readingTime: document.getElementById('readTime').textContent,
                    speakingTime: document.getElementById('speakTime').textContent
                },
                timestamp: new Date().toISOString(),
                version: 'Text Tools Pro+ v2.1'
            };
            
            download(JSON.stringify(data, null, 2), 'text-tools-export.json', 'application/json');
            showMessage('All data exported');
        }
        
        // Download functions
        function downloadTXT() {
            download(textArea.value, 'text.txt', 'text/plain');
            showMessage('TXT file downloaded');
        }
        
        function downloadHTML() {
            const html = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Exported Text</title></head><body><pre>${escapeHtml(textArea.value)}</pre></body></html>`;
            download(html, 'text.html', 'text/html');
            showMessage('HTML file downloaded');
        }
        
        function downloadMD() {
            download(textArea.value, 'text.md', 'text/markdown');
            showMessage('Markdown file downloaded');
        }
        
        function downloadJSON() {
            const data = {
                text: textArea.value,
                stats: {
                    words: document.getElementById('words').textContent,
                    characters: document.getElementById('chars').textContent,
                    sentences: document.getElementById('sentences').textContent,
                    paragraphs: document.getElementById('paras').textContent,
                    uniqueWords: document.getElementById('unique').textContent,
                    readingTime: document.getElementById('readTime').textContent,
                    speakingTime: document.getElementById('speakTime').textContent
                },
                timestamp: new Date().toISOString()
            };
            download(JSON.stringify(data, null, 2), 'text.json', 'application/json');
            showMessage('JSON file downloaded');
        }
        
        function downloadPDF() {
            // Open print dialog for PDF generation
            window.print();
            showMessage('PDF generated (use print to save as PDF)');
        }
        
        function copyText() {
            navigator.clipboard.writeText(textArea.value)
                .then(() => showMessage('Copied to clipboard'))
                .catch(() => showMessage('Failed to copy'));
        }
        
        function clearText() {
            if (confirm('Are you sure you want to clear all text?')) {
                saveHistory();
                textArea.value = '';
                analyze();
                showMessage('Text cleared');
            }
        }
        
        function toggleAdvanced() {
            // This function can be expanded to show/hide additional advanced features
            showMessage('Advanced features are integrated throughout the tabs');
        }
        
        function toggleDark() {
            const isDark = document.documentElement.classList.toggle('dark');
            const btn = event.target;
            btn.innerHTML = isDark ? '<i class="bi bi-sun"></i> Light' : '<i class="bi bi-moon"></i> Dark';
            saveSetting('darkMode', isDark);
            showMessage(isDark ? 'Dark mode enabled' : 'Light mode enabled');
        }
        
        function showToolInfo(toolName) {
            const toolInfo = {
                'Word Counter': 'Counts the number of words in your text',
                'Character Counter': 'Counts total characters including spaces',
                'Sentence Counter': 'Counts complete sentences',
                'Paragraph Counter': 'Counts text paragraphs',
                'Reading Time Calculator': 'Estimates reading time (200 words/minute)',
                'Speaking Time Calculator': 'Estimates speaking time (130 words/minute)',
                'Text Length Checker': 'Categorizes text as Short, Medium, or Long',
                'Unique Words': 'Counts distinct words in your text'
            };
            
            if (toolInfo[toolName]) {
                showMessage(`${toolName}: ${toolInfo[toolName]}`);
            }
        }
        
        // Utility functions
        function download(data, filename, type) {
            const blob = new Blob([data], { type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }
        
        function escapeHtml(text) {
            return text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }
        
        function showMessage(message) {
            const output = document.getElementById('output');
            output.textContent = message;
            output.classList.add('fade-in');
            
            setTimeout(() => {
                output.textContent = '';
                output.classList.remove('fade-in');
            }, 3000);
        }
        
        // Settings management
        function saveSetting(key, value) {
            const settings = JSON.parse(localStorage.getItem('textToolsSettings') || '{}');
            settings[key] = value;
            localStorage.setItem('textToolsSettings', JSON.stringify(settings));
        }
        
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('textToolsSettings') || '{}');
            
            if (settings.darkMode) {
                document.documentElement.classList.add('dark');
                document.querySelector('.btn-outline-dark').innerHTML = '<i class="bi bi-sun"></i> Light';
            }
            
            if (settings.fontSize) {
                fontSize = settings.fontSize;
                textArea.style.fontSize = fontSize + 'px';
            }
            
            if (settings.fontFamily) {
                textArea.style.fontFamily = settings.fontFamily;
            }
        }
        
        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
